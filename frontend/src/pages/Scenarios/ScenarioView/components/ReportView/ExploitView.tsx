import { IReportItem } from "@services/types/processes";
import { FC } from "react";
import { MainViewBody, MainViewContainer, MainViewHeader, SubContainer, SubContainerHeader, Table, Td, Th } from "./BaseTags";
import styled from "styled-components";


interface IExploitView{
    exploit: IReportItem
}
export const ExploitView: FC<IExploitView> = ({exploit}) => {
    if(!exploit || !exploit.info.length){
        return(<></>)
    }
    return (
        <MainViewContainer>
            <MainViewHeader> Блок: Эксплуатация </MainViewHeader>
            <MainViewBody>
                {
                    exploit.info.map( ex => {
                        return (
                            <ViewExploitInfo item={ex}/>
                        )
                    })
                }
            </MainViewBody>
        </MainViewContainer>
    )
}

const ViewExploitInfo: FC<{item: any}> = ({item}) => {
    return (
        <SubContainer>
            <SubContainerHeader>
                <CveName>{item.name.toUpperCase()}</CveName>
                <HostName>{`${item.result.host}:${item.result.port}`}</HostName>
            </SubContainerHeader>
            <Table>
                <thead>
                    <tr>
                        <Th>#</Th>
                        <Th>Полезная нагрузка</Th>
                        <Th>Результат</Th>
                    </tr>
                </thead>
                <tbody>
                    {
                        item.result.messages && item.result.messages.length ? 
                        item.result.messages.map( (m,index) => {
                            return (
                                <tr>
                                    <Td> {index+1} </Td>
                                    <Td> {m?.payload || m?.command} </Td>
                                    <Td> {m.message} </Td>
                                </tr>
                            )
                        } )
                        :null
                    }
                </tbody>
            </Table>
        </SubContainer>
    )
}

const CveName = styled.div`
    
`

const HostName = styled.div`
    
`